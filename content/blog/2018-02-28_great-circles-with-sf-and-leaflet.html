---
title: Great circles with sf and leaflet
author: Martin John Hadley
date: '2018-02-28'
slug: great-circles-with-sf-and-leaflet
categories:
  - R
tags:
  - R
  - dataviz
draft: no
description: "Great circles are the shortest journeys between two points on a map, which can be easily computed and manipulated through the use of the excellent sf library, and visualised interactively with leaflet."
editor_options: 
  chunk_output_type: console
banner: "img/blog-images/header-images/2018-02-28_great-circles-with-sf.png"
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/blazy/blazy.min.js"></script>
<script src="/rmarkdown-libs/pymjs/pym.v1.js"></script>
<script src="/rmarkdown-libs/widgetframe-binding/widgetframe.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet/leaflet.js"></script>
<link href="/rmarkdown-libs/leafletfix/leafletfix.css" rel="stylesheet" />
<link href="/rmarkdown-libs/leaflet-label/leaflet.label.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet-label/leaflet.label.js"></script>
<script src="/rmarkdown-libs/Proj4Leaflet/proj4-compressed.js"></script>
<script src="/rmarkdown-libs/Proj4Leaflet/proj4leaflet.js"></script>
<script src="/rmarkdown-libs/leaflet-binding/leaflet.js"></script>



<hr style="margin-top: -10px;margin-bottom: 5px;">
<div class="row">
    <div class="col-sm-4">
        <center> <span class="fa fa-star fa-2x text-center" style="color:Tomato"></span>
            <p><a href='/reproducability-ratings' data-toggle="tooltip" data-placement="right" title="" data-original-title="Click for info" style='font-weight:bold;color:black;text-decoration:underline;' target='_blank'>Citable Author<i class="fa fa-question-circle "></i></a>
                <br>
                Martin John Hadley
                <br>
                (<a href="https://orcid.org/0000-0002-3039-6849" target="orcid.widget" rel="noopener noreferrer" style="vertical-align:top;"  target='_blank'><img src="/img/orcid_16x16.png" style="width:1em;margin-right:.2em;" alt="ORCID iD icon">orcid.org/0000-0002-3039-6849</a>)
        </center>
    </div>
    <div class="col-sm-4">
        <center> <span class="fa fa-star fa-2x text-center" style="color:Tomato"></span>
            <p><a href='/reproducability-ratings' data-toggle="tooltip" data-placement="right" title="" data-original-title="Click for info" style='font-weight:bold;color:black;text-decoration:underline;' target='_blank'>Citable Data<i class="fa fa-question-circle "></i></a>
                <br>
                No real data used.
        </center>
    </div>
    <div class="col-sm-4">
        <center> <span class="fa fa-star-half-o fa-2x text-center" style="color:Tomato"></span>
            <p><a href='/reproducability-ratings' data-toggle="tooltip" data-placement="right" title="" data-original-title="Click for info" style='font-weight:bold;color:black;text-decoration:underline;' target='_blank'>Citable Code<i class="fa fa-question-circle "></i></a>
                <br>
                <a href="https://github.com/visibledata/visibledata.github.io/blob/master/content/blog/2018-02-28_great-circles-with-sf.Rmd" target="orcid.widget" rel="noopener noreferrer" style="vertical-align:top;"  target='_blank'><img src="/img/GitHub-Mark-32px.png" style="width:1em;margin-right:.5em;" alt="GitHub icon">.Rmd on GitHub</a>
        </center>
    </div>
</div>

<hr style="margin-top: 5px;margin-bottom: 5px;">


<div class="row">
<div class="col-sm-6">
<p>Surprisingly often I’m asked to help folks build maps which visualise the journeys between geographic locations, in the bad old days of early 2017 I would have used the <code>geospheres</code> package and <code>sp</code>.</p>
<p>That’s because the shortest distance between two points on a map is a <strong>great circle</strong>, and <code>geospheres</code> is capable of computing such things. Note that it’s these great circles that you see on flight information screens, their exact curvature depends on the projection of the map.</p>
</div>
<div class="col-sm-6">
<center>
<img src='/img/blog-images/header-images/2018-02-28_great-circles-with-sf.png' style='max-width:350px'/>
</center>
</div>
</div>
<p><br> However, I’m now an <code>sf</code> convert and try to do everything within that package. In my original version of this blogpost I introduced my painfully inefficient way to compute these great circles with <code>sf</code> and asked folks in the <a href="https://medium.com/@kierisi/r4ds-the-next-iteration-d51e0a1b0b82">R4DS Slack group</a> run by <a href="https://www.jessemaegan.com/">Jesse Maegan</a> if they had any suggested improvements, which I’ve now baked in below.</p>
<p>Typically my datasets are collections of journeys, here’s an example of what the data looks like (these are some of the journeys I took during the 3 years I worked for Wolfram Research):</p>
<pre class="r"><code>library(&quot;tidyverse&quot;)
library(&quot;sf&quot;)
raw_journey_data &lt;- tribble(
  ~start.long, ~start.lat, ~end.long, ~end.lat, ~name,
  -0.118092, 51.509865, -119.698189, 34.420830, &quot;London to Santa Barbara&quot;,
  31.496773, 30.026300, 24.753574, 59.436962, &quot;New Cairo to Tallinn&quot;,
  126.633333, 45.75, 46.738586, 24.774265, &quot;Harbin to Riyadh&quot;
)
raw_journey_data</code></pre>
<div id="htmlwidget-1" style="width:100%;height:100%;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"url":"/blog/2018-02-28_great-circles-with-sf-and-leaflet_files/figure-html//widgets/widget_hidden-dt.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
<p>I’ve split this post into two sections below:</p>
<ul>
<li>journeys_to_sf: A function for reliably converting journey data to an <code>sf</code> object that can be plotted with <code>leaflet</code> and <code>ggplot2</code></li>
<li>Creating <code>sf</code> features from <code>data.frames</code></li>
</ul>
<div id="journeys_to_sf" class="section level1">
<h1>journeys_to_sf</h1>
<p>Here’s my function for converting a <code>data.frame</code> containing journeys to a usable <code>&quot;sf&quot; &quot;data.frame&quot;</code> through the use of <a href="http://dplyr.tidyverse.org/articles/programming.html">tidyeval</a>:</p>
<pre class="r"><code>journeys_to_sf &lt;- function(journeys_data,
                           start_long = start.long,
                           start_lat = start.lat,
                           end_long = end.long,
                           end_lat = end.lat) {
  quo_start_long &lt;- enquo(start_long)
  quo_start_lat &lt;- enquo(start_lat)
  quo_end_long &lt;- enquo(end_long)
  quo_end_lat &lt;- enquo(end_lat)

  journeys_data %&gt;%
    select(
      !! quo_start_long,
      !! quo_start_lat,
      !! quo_end_long,
      !! quo_end_lat
    ) %&gt;%
    transpose() %&gt;%
    map(~ matrix(flatten_dbl(.), nrow = 2, byrow = TRUE)) %&gt;%
    map(st_linestring) %&gt;%
    st_sfc(crs = 4326) %&gt;%
    st_sf(geometry = .) %&gt;%
    bind_cols(journeys_data) %&gt;%
    select(everything(), geometry)
}</code></pre>
<p>This can very easily be inserted into a pipe chain for visualising with <code>leaflet</code>:</p>
<pre class="r"><code>library(&quot;leaflet&quot;)
raw_journey_data %&gt;%
  journeys_to_sf() %&gt;%
  st_segmentize(units::set_units(100, km)) %&gt;%
  leaflet() %&gt;%
  addTiles() %&gt;%
  addPolylines() %&gt;%
  addCircleMarkers(
    lng = ~start.long,
    lat = ~start.lat,
    color = &quot;green&quot;,
    opacity = 1,
    radius = 2
  ) %&gt;%
  addCircleMarkers(
    lng = ~end.long,
    lat = ~end.lat,
    color = &quot;red&quot;,
    opacity = 1,
    radius = 2
  ) %&gt;%
  addLegend(
    colors = c(
      &quot;green&quot;,
      &quot;red&quot;
    ),
    labels = c(
      &quot;Journey start&quot;,
      &quot;Journey end&quot;
    )
  )</code></pre>
<p><div id="htmlwidget-2" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"maxNativeZoom":null,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"continuousWorld":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPolylines","args":[[[[{"lng":[-0.118092,-1.17546357153127,-2.26155407504208,-3.37728092273742,-4.52355160713613,-5.7012563193225,-6.91125950907213,-8.1543903208853,-9.43143185323662,-10.7431092072859,-12.0900763168112,-13.4729015840775,-14.8920523874271,-16.3478785759772,-17.840595124917,-19.3702641908767,-20.9367768793383,-22.5398351127325,-24.178934065378,-25.853345705266,-27.5621040473312,-29.3039927718246,-31.0775358877376,-32.880992117938,-34.7123536435145,-36.5693497650886,-38.4494559163195,-40.3499083005216,-42.2677242201602,-44.1997279399916,-46.1425816806096,-48.0928210960274,-50.0468943642005,-52.0012038305891,-53.9521490074701,-55.8961696574627,-57.8297876850909,-59.749646625578,-61.6525476497504,-63.5354811868212,-65.3956534878116,-67.2305076941118,-69.0377392205199,-70.8153054938766,-72.5614302938109,-74.2746031116103,-75.9535740713756,-77.5973450428966,-79.2051576199415,-80.7764786453096,-82.3109839411527,-83.8085408566607,-85.2691901822345,-86.6931279062935,-88.0806872135545,-89.4323210466152,-90.7485854794836,-92.0301240847593,-93.2776534169864,-94.4919496839721,-95.6738366356893,-96.8241746664009,-97.9438510991999,-99.0337716024107,-100.094852673337,-101.128015115727,-102.134178432198,-103.114256050879,-104.069151306002,-104.999754094477,-105.90693813408,-106.791558753373,-107.654451148495,-108.496429047256,-109.318283726312,-110.120783332469,-110.904672464215,-111.670671974379,-112.419478959282,-113.151766903851,-113.868185955957,-114.569363306638,-115.255903655943,-115.928389746885,-116.587382952447,-117.23342390273,-117.867033141263,-118.488711801169,-119.09894229333,-119.698189],"lat":[51.509865,52.1120911941854,52.7046021694843,53.2869176234257,53.858535054817,54.4189294174047,54.9675529183898,55.5038349919686,56.0271824810978,56.5369800634765,57.0325909601423,57.5133579668467,57.9786048492616,58.4276381427604,58.8597493956914,59.2742178913695,59.6703138781157,60.0473023282739,60.40444723599,60.7410164495479,61.0562870172457,61.3495510064459,61.6201217340275,61.8673403238026,62.0905824835961,62.2892653729382,62.4628544131925,62.610869877038,62.7328930850876,62.8285720353998,62.8976262977022,62.9398510187353,62.9551199080671,62.943387104144,62.9046878567301,62.8391380021483,62.7469322494718,62.6283413364111,62.4837081506661,62.3134429438052,62.1180177887247,61.8979604474443,61.6538478231642,61.3862991694977,61.0959692215163,60.7835413990125,60.4497212137178,60.0952299907222,59.7207989915412,59.3271640035187,58.9150604386355,58.4852189651358,58.0383616782231,57.5751988017104,57.0964259009944,56.6027215789771,56.094745620347,55.5731375456741,55.0385155347192,54.491475677872,53.9325915153804,53.3624138257002,52.7814706266313,52.1902673556595,51.5892871989284,50.9789915413585,50.3598205135005,49.7321936136789,49.0965103867804,48.4531511436412,47.8024777073641,47.1448341750373,46.4805476852418,45.8099291834209,45.1332741786671,44.4508634867636,43.7629639554217,43.0698291686032,42.371700127613,41.668805907324,40.9613642864565,40.2495823512997,39.5336570726436,38.8137758559986,38.090117065427,37.3628505215061,36.6321379740911,35.8981335506638,35.1609841811314,34.42083]}]],[[{"lng":[31.496773,31.3740807990202,31.2491411869552,31.1218330815247,30.9920286035487,30.8595925323986,30.7243817112597,30.5862443966155,30.4450195456477,30.3005360344353,30.1526117988947,30.0010528893293,29.8456524282126,29.6861894593972,29.5224276752812,29.354114006538,29.1809770567771,29.0027253618929,28.819045450809,28.6295996807529,28.4340238159988,28.2319243140738,28.0228752775855,27.8064150229147,27.5820422088022,27.3492114580737,27.1073283940456,26.855743999127,26.5937481862565,26.3205624534321,26.0353314669107,25.7371133886371,25.4248687268359,25.0974474438328,24.753574],"lat":[30.0263,30.8953021075939,31.7641863320039,32.6329463047998,33.5015752981722,34.3700661959859,35.2384114621474,36.1066031059827,36.9746326442852,37.8424910596493,38.7101687546525,39.5776555013906,40.4449403858029,41.3120117461446,42.1788571048733,43.0454630931083,43.9118153667009,44.777898512805,45.6436959456717,46.5091897901902,47.3743607514642,48.2391879684354,49.1036488492374,49.9677188855756,50.8313714429613,51.6945775230747,52.5573054938634,53.4195207821799,54.2811855227926,55.1422581564221,56.0026929680268,56.8624395547992,57.7214422111839,58.5796392155685,59.436962]}]],[[{"lng":[126.633333,125.381533977633,124.122495769069,122.856771452481,121.584939620079,120.307602619984,119.025384584137,117.738929254695,116.44889762472,115.155965412182,113.860820389229,112.564159591312,111.266686432984,109.969107758906,108.672130859846,107.376460484122,106.082795875011,104.791827864168,103.504236050022,102.220686088538,100.941827121624,99.6682893659841,98.400681882321,97.139590541692,95.8855762024696,94.6391731079544,93.4008875112374,92.1711965305363,90.9505472349927,89.7393559578749,88.5380078313505,87.3468565345063,86.1662242441298,84.9964017759551,83.8376489026132,82.6901948334153,81.5542388403295,80.4299510140564,79.317473133961,78.2169196357245,77.1283786609328,76.0519131733637,74.9875621274517,73.9353416752564,72.8952463992125,71.8672505589566,70.8513093415935,69.8473601058446,68.8553236116051,67.8751052274971,66.9065961100286,65.9496743489539,65.0042060743451,64.0700465217521,63.1470410526158,62.2350261278237,61.3338302329506,60.4432747543083,59.5631748054449,58.6933400041826,57.8335752006742,56.9836811572856,56.1434551813924,55.3126917124046,54.4911828645197,53.6787189268456,52.8750888226442,52.0800805295227,51.2934814624495,50.5150788214916,49.7446599061814,48.9820123984002,48.2269246156421,47.4791857364793,46.738586],"lat":[45.75,45.9168759474871,46.0700040431774,46.2092339083211,46.3344270120044,46.4454573015437,46.5422117882914,46.6245910826617,46.6925098725597,46.7458973398939,46.7846975104424,46.8088695330362,46.8183878847936,46.8132424999818,46.7934388209711,46.7589977706758,46.709955646808,46.6463639392072,46.5682890724064,46.4758120764572,46.3690281898291,46.2480463989138,46.1129889192915,45.963990624436,45.8011984279519,45.6247706257404,45.4348762046752,45.2316941244536,45.0154125792573,44.786228245733,44.5443455235882,44.2899757748024,44.0233365670951,43.7446509268748,43.4541466064367,43.1520553696873,42.8386123001698,42.5140551346485,42.1786236250005,41.8325589306607,41.4761030433867,41.1094982456503,40.7329866035371,40.3468094946385,39.951207171065,39.546418357384,39.1326798830055,38.710226348288,38.2792898234322,37.8400995790471,37.3928818471396,36.9378596111581,36.4752524236429,36.0052762499759,35.5281433366849,35.0440621027464,34.553237052329,34.0558687074406,33.5521535589699,33.0422840346558,32.5264484825667,32.0048311687272,31.4776122875942,30.9449679841445,30.4070703864089,29.8640876473528,29.3161839950742,28.7635197903597,28.2062515907033,27.644532219965,27.0785108429034,26.5083330438838,25.9341409091194,25.3560731118607,24.774265]}]]],null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":false,"fillColor":"#03F","fillOpacity":0.2,"dashArray":null,"smoothFactor":1,"noClip":false},null,null,null,null,null]},{"method":"addCircleMarkers","args":[[51.509865,30.0263,45.75],[-0.118092,31.496773,126.633333],2,null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"green","weight":5,"opacity":1,"fill":true,"fillColor":"green","fillOpacity":0.2,"dashArray":null},null,null,null,null,null,null,null]},{"method":"addCircleMarkers","args":[[34.42083,59.436962,24.774265],[-119.698189,24.753574,46.738586],2,null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"red","weight":5,"opacity":1,"fill":true,"fillColor":"red","fillOpacity":0.2,"dashArray":null},null,null,null,null,null,null,null]},{"method":"addLegend","args":[{"colors":["green","red"],"labels":["Journey start","Journey end"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"unknown","title":null,"extra":null,"layerId":null,"className":"info legend"}]}],"limits":{"lat":[24.774265,62.9551199080671],"lng":[-119.698189,126.633333]}},"evals":[],"jsHooks":[]}</script> <br></p>
<p>A quick note to say, <code>leaflet</code> is an awesome <code>htmlwidget</code> for building interactive maps. If you’ve never heard of <code>htmlwidgets</code> before, check out my blogpost; <a href="http://www.visibledata.co.uk/blog/2018/02/07/2018-02-07_where-s-the-love-for-htmlwidgets/">where’s the love for htmlwidgets?</a></p>
</div>
<div id="creating-sf-features-from-data.frame" class="section level1">
<h1>Creating <code>sf</code> features from <code>data.frame</code></h1>
<p>The <code>sf</code> library allows R folks to work with GIS data using the very widely used <a href="https://en.wikipedia.org/wiki/Simple_Features">Simple Features</a> standard for working with 2D geometries. All <code>sf</code> objects are constructed from a combination of 17 unique “simple features”, which are usefully <a href="https://r-spatial.github.io/sf/articles/sf1.html#simple-feature-geometry-types">summarised here</a>.</p>
<p>Originally my blogpost used a quite inefficient method for converting <code>data.frame</code> to <code>sf</code>. Thankfully I’m a member of the excellent <a href="https://www.jessemaegan.com/post/r4ds-the-next-iteration/">R4DS Slack group</a> and I got great advice from <a href="https://twitter.com/vivalosburros">Jesse Sadler</a> and <a href="http://kentsjohnson.com/">Kent Johnson</a>. Here’s my old horrible method of doing things:</p>
<pre class="r"><code>start_locs &lt;- raw_journey_data %&gt;%
  select(
    start.long,
    start.lat
  ) %&gt;%
  setNames(c(&quot;long&quot;, &quot;lat&quot;)) %&gt;%
  mutate(journey_id = row_number())

end_locs &lt;- raw_journey_data %&gt;%
  select(
    end.long,
    end.lat
  ) %&gt;%
  setNames(c(&quot;long&quot;, &quot;lat&quot;)) %&gt;%
  mutate(journey_id = row_number())

journey_data_linestrings &lt;- start_locs %&gt;%
  bind_rows(end_locs) %&gt;%
  st_as_sf(coords = c(&quot;long&quot;, &quot;lat&quot;)) %&gt;%
  group_by(journey_id) %&gt;%
  arrange(journey_id) %&gt;%
  summarise() %&gt;%
  st_cast(&quot;LINESTRING&quot;)

journey_data_linestrings &lt;- st_set_crs(journey_data_linestrings, st_crs(4326))

journey_data &lt;- raw_journey_data
st_geometry(journey_data) &lt;- st_geometry(journey_data_linestrings)
journey_data</code></pre>
<pre><code>## Simple feature collection with 3 features and 5 fields
## geometry type:  LINESTRING
## dimension:      XY
## bbox:           xmin: -119.6982 ymin: 24.77426 xmax: 126.6333 ymax: 59.43696
## epsg (SRID):    4326
## proj4string:    +proj=longlat +datum=WGS84 +no_defs
##   start.long start.lat   end.long  end.lat                    name
## 1  -0.118092  51.50986 -119.69819 34.42083 London to Santa Barbara
## 2  31.496773  30.02630   24.75357 59.43696    New Cairo to Tallinn
## 3 126.633333  45.75000   46.73859 24.77426        Harbin to Riyadh
##                         geometry
## 1 LINESTRING (-119.698189 34....
## 2 LINESTRING (24.753574 59.43...
## 3 LINESTRING (46.738586 24.77...</code></pre>
<p>Let’s go through the stages required and re-write my method to be more <code>purrr</code> dependent:</p>
<ol style="list-style-type: decimal">
<li>Create a list of <code>LINESTRING</code>s</li>
<li>Combine the list <code>LINESTRING</code>s into a collection of <code>sf</code> features</li>
<li>Join this collection of <code>sf</code> features with the original dataset</li>
</ol>
<div id="linestrings" class="section level2">
<h2>LINESTRINGs</h2>
<p>We need <code>LINESTRING</code>s for our great circles as these represent a <em>“sequence of points connected by straight, non-self intersecting line pieces; one-dimensional geometry”</em>. As with all simple features, <code>LINESTRING</code>s are constructed from matrices:</p>
<pre class="r"><code>st_linestring(matrix(1:6, 3))</code></pre>
<pre><code>## LINESTRING (1 4, 2 5, 3 6)</code></pre>
<p>Let’s extract the start and end coordinates from our <code>raw_journeys_data</code> and convert them to a <code>list</code> with <code>purrr::transpose</code>:</p>
<pre class="r"><code>raw_journey_data %&gt;% 
  select(-name) %&gt;% 
  transpose()</code></pre>
<pre><code>## [[1]]
## [[1]]$start.long
## [1] -0.118092
## 
## [[1]]$start.lat
## [1] 51.50986
## 
## [[1]]$end.long
## [1] -119.6982
## 
## [[1]]$end.lat
## [1] 34.42083
## 
## 
## [[2]]
## [[2]]$start.long
## [1] 31.49677
## 
## [[2]]$start.lat
## [1] 30.0263
## 
## [[2]]$end.long
## [1] 24.75357
## 
## [[2]]$end.lat
## [1] 59.43696
## 
## 
## [[3]]
## [[3]]$start.long
## [1] 126.6333
## 
## [[3]]$start.lat
## [1] 45.75
## 
## [[3]]$end.long
## [1] 46.73859
## 
## [[3]]$end.lat
## [1] 24.77426</code></pre>
<p>These lists can easily be converted to matrices using <code>map</code>:</p>
<pre class="r"><code>raw_journey_data %&gt;% 
  select(-name) %&gt;% 
  transpose() %&gt;% 
  map(~ matrix(flatten_dbl(.), nrow = 2, byrow = TRUE)) </code></pre>
<pre><code>## [[1]]
##             [,1]     [,2]
## [1,]   -0.118092 51.50986
## [2,] -119.698189 34.42083
## 
## [[2]]
##          [,1]     [,2]
## [1,] 31.49677 30.02630
## [2,] 24.75357 59.43696
## 
## [[3]]
##           [,1]     [,2]
## [1,] 126.63333 45.75000
## [2,]  46.73859 24.77426</code></pre>
<p>… and finally we can convert these to</p>
<pre class="r"><code>list_of_linestrings &lt;- raw_journey_data %&gt;%
  select(-name) %&gt;%
  transpose() %&gt;%
  map(~ matrix(flatten_dbl(.), nrow = 2, byrow = TRUE)) %&gt;%
  map(st_linestring)
list_of_linestrings</code></pre>
<pre><code>## LINESTRING (-0.118092 51.509865, -119.698189 34.42083)</code></pre>
<pre><code>## LINESTRING (31.496773 30.0263, 24.753574 59.436962)</code></pre>
<pre><code>## LINESTRING (126.633333 45.75, 46.738586 24.774265)</code></pre>
</div>
<div id="collecting-features" class="section level2">
<h2>Collecting features</h2>
<p>Eventually we will create an <code>&quot;sf&quot; &quot;data.frame&quot;</code> which contains our <code>LINESTRING</code>s in the <code>geometry</code> column. We create a set of features for this column from our list of <code>LINESTRING</code>s with the <code>st_sfc</code> function. Note that we need to specify a coordinate system, the most obvious choice is the WGS84 coordinate reference system, that’s why we specify <code>crs = 4326</code>:</p>
<pre class="r"><code>list_of_linestrings %&gt;%
  st_sfc(crs = 4326)</code></pre>
<pre><code>## Geometry set for 3 features 
## geometry type:  LINESTRING
## dimension:      XY
## bbox:           xmin: -119.6982 ymin: 24.77426 xmax: 126.6333 ymax: 59.43696
## epsg (SRID):    4326
## proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<p>Now we have this set of features we create a collection of them in a <code>&quot;sf&quot; &quot;data.frame&quot;</code> with <code>st_sf</code>:</p>
<pre class="r"><code>collection_sf &lt;- list_of_linestrings %&gt;%
  st_sfc(crs = 4326) %&gt;%
  st_sf(geometry = .)
collection_sf</code></pre>
<pre><code>## Simple feature collection with 3 features and 0 fields
## geometry type:  LINESTRING
## dimension:      XY
## bbox:           xmin: -119.6982 ymin: 24.77426 xmax: 126.6333 ymax: 59.43696
## epsg (SRID):    4326
## proj4string:    +proj=longlat +datum=WGS84 +no_defs
##                         geometry
## 1 LINESTRING (-0.118092 51.50...
## 2 LINESTRING (31.496773 30.02...
## 3 LINESTRING (126.633333 45.7...</code></pre>
</div>
<div id="joining-feature-collections-with-data" class="section level2">
<h2>Joining feature collections with data</h2>
<p>As <code>sf</code> collections store all of the GIS data in a column it’s very easy to combine this object with our original data - we use <code>dplyr::bind_columns</code></p>
<pre class="r"><code>collection_sf %&gt;%
  bind_cols(raw_journey_data)</code></pre>
<pre><code>## Simple feature collection with 3 features and 5 fields
## geometry type:  LINESTRING
## dimension:      XY
## bbox:           xmin: -119.6982 ymin: 24.77426 xmax: 126.6333 ymax: 59.43696
## epsg (SRID):    4326
## proj4string:    +proj=longlat +datum=WGS84 +no_defs
##                         geometry start.long start.lat   end.long  end.lat
## 1 LINESTRING (-0.118092 51.50...  -0.118092  51.50986 -119.69819 34.42083
## 2 LINESTRING (31.496773 30.02...  31.496773  30.02630   24.75357 59.43696
## 3 LINESTRING (126.633333 45.7... 126.633333  45.75000   46.73859 24.77426
##                      name
## 1 London to Santa Barbara
## 2    New Cairo to Tallinn
## 3        Harbin to Riyadh</code></pre>
<p>We can now perform calculations on our dataset, for instance compute great circles with a resolution of 100km:</p>
<pre class="r"><code>collection_sf %&gt;%
  bind_cols(raw_journey_data) %&gt;%
  st_segmentize(units::set_units(100, km)) %&gt;%
  leaflet() %&gt;%
  addTiles() %&gt;%
  addPolylines(label = ~name)</code></pre>
<div id="htmlwidget-3" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"maxNativeZoom":null,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"continuousWorld":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPolylines","args":[[[[{"lng":[-0.118092,-1.17546357153127,-2.26155407504208,-3.37728092273742,-4.52355160713613,-5.7012563193225,-6.91125950907213,-8.1543903208853,-9.43143185323662,-10.7431092072859,-12.0900763168112,-13.4729015840775,-14.8920523874271,-16.3478785759772,-17.840595124917,-19.3702641908767,-20.9367768793383,-22.5398351127325,-24.178934065378,-25.853345705266,-27.5621040473312,-29.3039927718246,-31.0775358877376,-32.880992117938,-34.7123536435145,-36.5693497650886,-38.4494559163195,-40.3499083005216,-42.2677242201602,-44.1997279399916,-46.1425816806096,-48.0928210960274,-50.0468943642005,-52.0012038305891,-53.9521490074701,-55.8961696574627,-57.8297876850909,-59.749646625578,-61.6525476497504,-63.5354811868212,-65.3956534878116,-67.2305076941118,-69.0377392205199,-70.8153054938766,-72.5614302938109,-74.2746031116103,-75.9535740713756,-77.5973450428966,-79.2051576199415,-80.7764786453096,-82.3109839411527,-83.8085408566607,-85.2691901822345,-86.6931279062935,-88.0806872135545,-89.4323210466152,-90.7485854794836,-92.0301240847593,-93.2776534169864,-94.4919496839721,-95.6738366356893,-96.8241746664009,-97.9438510991999,-99.0337716024107,-100.094852673337,-101.128015115727,-102.134178432198,-103.114256050879,-104.069151306002,-104.999754094477,-105.90693813408,-106.791558753373,-107.654451148495,-108.496429047256,-109.318283726312,-110.120783332469,-110.904672464215,-111.670671974379,-112.419478959282,-113.151766903851,-113.868185955957,-114.569363306638,-115.255903655943,-115.928389746885,-116.587382952447,-117.23342390273,-117.867033141263,-118.488711801169,-119.09894229333,-119.698189],"lat":[51.509865,52.1120911941854,52.7046021694843,53.2869176234257,53.858535054817,54.4189294174047,54.9675529183898,55.5038349919686,56.0271824810978,56.5369800634765,57.0325909601423,57.5133579668467,57.9786048492616,58.4276381427604,58.8597493956914,59.2742178913695,59.6703138781157,60.0473023282739,60.40444723599,60.7410164495479,61.0562870172457,61.3495510064459,61.6201217340275,61.8673403238026,62.0905824835961,62.2892653729382,62.4628544131925,62.610869877038,62.7328930850876,62.8285720353998,62.8976262977022,62.9398510187353,62.9551199080671,62.943387104144,62.9046878567301,62.8391380021483,62.7469322494718,62.6283413364111,62.4837081506661,62.3134429438052,62.1180177887247,61.8979604474443,61.6538478231642,61.3862991694977,61.0959692215163,60.7835413990125,60.4497212137178,60.0952299907222,59.7207989915412,59.3271640035187,58.9150604386355,58.4852189651358,58.0383616782231,57.5751988017104,57.0964259009944,56.6027215789771,56.094745620347,55.5731375456741,55.0385155347192,54.491475677872,53.9325915153804,53.3624138257002,52.7814706266313,52.1902673556595,51.5892871989284,50.9789915413585,50.3598205135005,49.7321936136789,49.0965103867804,48.4531511436412,47.8024777073641,47.1448341750373,46.4805476852418,45.8099291834209,45.1332741786671,44.4508634867636,43.7629639554217,43.0698291686032,42.371700127613,41.668805907324,40.9613642864565,40.2495823512997,39.5336570726436,38.8137758559986,38.090117065427,37.3628505215061,36.6321379740911,35.8981335506638,35.1609841811314,34.42083]}]],[[{"lng":[31.496773,31.3740807990202,31.2491411869552,31.1218330815247,30.9920286035487,30.8595925323986,30.7243817112597,30.5862443966155,30.4450195456477,30.3005360344353,30.1526117988947,30.0010528893293,29.8456524282126,29.6861894593972,29.5224276752812,29.354114006538,29.1809770567771,29.0027253618929,28.819045450809,28.6295996807529,28.4340238159988,28.2319243140738,28.0228752775855,27.8064150229147,27.5820422088022,27.3492114580737,27.1073283940456,26.855743999127,26.5937481862565,26.3205624534321,26.0353314669107,25.7371133886371,25.4248687268359,25.0974474438328,24.753574],"lat":[30.0263,30.8953021075939,31.7641863320039,32.6329463047998,33.5015752981722,34.3700661959859,35.2384114621474,36.1066031059827,36.9746326442852,37.8424910596493,38.7101687546525,39.5776555013906,40.4449403858029,41.3120117461446,42.1788571048733,43.0454630931083,43.9118153667009,44.777898512805,45.6436959456717,46.5091897901902,47.3743607514642,48.2391879684354,49.1036488492374,49.9677188855756,50.8313714429613,51.6945775230747,52.5573054938634,53.4195207821799,54.2811855227926,55.1422581564221,56.0026929680268,56.8624395547992,57.7214422111839,58.5796392155685,59.436962]}]],[[{"lng":[126.633333,125.381533977633,124.122495769069,122.856771452481,121.584939620079,120.307602619984,119.025384584137,117.738929254695,116.44889762472,115.155965412182,113.860820389229,112.564159591312,111.266686432984,109.969107758906,108.672130859846,107.376460484122,106.082795875011,104.791827864168,103.504236050022,102.220686088538,100.941827121624,99.6682893659841,98.400681882321,97.139590541692,95.8855762024696,94.6391731079544,93.4008875112374,92.1711965305363,90.9505472349927,89.7393559578749,88.5380078313505,87.3468565345063,86.1662242441298,84.9964017759551,83.8376489026132,82.6901948334153,81.5542388403295,80.4299510140564,79.317473133961,78.2169196357245,77.1283786609328,76.0519131733637,74.9875621274517,73.9353416752564,72.8952463992125,71.8672505589566,70.8513093415935,69.8473601058446,68.8553236116051,67.8751052274971,66.9065961100286,65.9496743489539,65.0042060743451,64.0700465217521,63.1470410526158,62.2350261278237,61.3338302329506,60.4432747543083,59.5631748054449,58.6933400041826,57.8335752006742,56.9836811572856,56.1434551813924,55.3126917124046,54.4911828645197,53.6787189268456,52.8750888226442,52.0800805295227,51.2934814624495,50.5150788214916,49.7446599061814,48.9820123984002,48.2269246156421,47.4791857364793,46.738586],"lat":[45.75,45.9168759474871,46.0700040431774,46.2092339083211,46.3344270120044,46.4454573015437,46.5422117882914,46.6245910826617,46.6925098725597,46.7458973398939,46.7846975104424,46.8088695330362,46.8183878847936,46.8132424999818,46.7934388209711,46.7589977706758,46.709955646808,46.6463639392072,46.5682890724064,46.4758120764572,46.3690281898291,46.2480463989138,46.1129889192915,45.963990624436,45.8011984279519,45.6247706257404,45.4348762046752,45.2316941244536,45.0154125792573,44.786228245733,44.5443455235882,44.2899757748024,44.0233365670951,43.7446509268748,43.4541466064367,43.1520553696873,42.8386123001698,42.5140551346485,42.1786236250005,41.8325589306607,41.4761030433867,41.1094982456503,40.7329866035371,40.3468094946385,39.951207171065,39.546418357384,39.1326798830055,38.710226348288,38.2792898234322,37.8400995790471,37.3928818471396,36.9378596111581,36.4752524236429,36.0052762499759,35.5281433366849,35.0440621027464,34.553237052329,34.0558687074406,33.5521535589699,33.0422840346558,32.5264484825667,32.0048311687272,31.4776122875942,30.9449679841445,30.4070703864089,29.8640876473528,29.3161839950742,28.7635197903597,28.2062515907033,27.644532219965,27.0785108429034,26.5083330438838,25.9341409091194,25.3560731118607,24.774265]}]]],null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":false,"fillColor":"#03F","fillOpacity":0.2,"dashArray":null,"smoothFactor":1,"noClip":false},null,null,["London to Santa Barbara","New Cairo to Tallinn","Harbin to Riyadh"],null,null]}],"limits":{"lat":[24.774265,62.9551199080671],"lng":[-119.698189,126.633333]}},"evals":[],"jsHooks":[]}</script>
<p>Sadly, there’s no good solution for adding arrow heads to these great circles - they would be heavily distorted by the map projection and would look ugly. An alternative solution to showing where journeys start and end is to use different coloured circle markers:</p>
<pre class="r"><code>collection_sf %&gt;%
  bind_cols(raw_journey_data) %&gt;%
  st_segmentize(units::set_units(100, km)) %&gt;%
  leaflet() %&gt;%
  addTiles() %&gt;%
  addPolylines() %&gt;%
  addCircleMarkers(
    lng = ~start.long,
    lat = ~start.lat,
    color = &quot;green&quot;,
    opacity = 1,
    radius = 2
  ) %&gt;%
  addCircleMarkers(
    lng = ~end.long,
    lat = ~end.lat,
    color = &quot;red&quot;,
    opacity = 1,
    radius = 2
  ) %&gt;%
  addLegend(
    colors = c(
      &quot;green&quot;,
      &quot;red&quot;
    ),
    labels = c(
      &quot;Journey start&quot;,
      &quot;Journey end&quot;
    )
  )</code></pre>
<div id="htmlwidget-4" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"maxNativeZoom":null,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"continuousWorld":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPolylines","args":[[[[{"lng":[-0.118092,-1.17546357153127,-2.26155407504208,-3.37728092273742,-4.52355160713613,-5.7012563193225,-6.91125950907213,-8.1543903208853,-9.43143185323662,-10.7431092072859,-12.0900763168112,-13.4729015840775,-14.8920523874271,-16.3478785759772,-17.840595124917,-19.3702641908767,-20.9367768793383,-22.5398351127325,-24.178934065378,-25.853345705266,-27.5621040473312,-29.3039927718246,-31.0775358877376,-32.880992117938,-34.7123536435145,-36.5693497650886,-38.4494559163195,-40.3499083005216,-42.2677242201602,-44.1997279399916,-46.1425816806096,-48.0928210960274,-50.0468943642005,-52.0012038305891,-53.9521490074701,-55.8961696574627,-57.8297876850909,-59.749646625578,-61.6525476497504,-63.5354811868212,-65.3956534878116,-67.2305076941118,-69.0377392205199,-70.8153054938766,-72.5614302938109,-74.2746031116103,-75.9535740713756,-77.5973450428966,-79.2051576199415,-80.7764786453096,-82.3109839411527,-83.8085408566607,-85.2691901822345,-86.6931279062935,-88.0806872135545,-89.4323210466152,-90.7485854794836,-92.0301240847593,-93.2776534169864,-94.4919496839721,-95.6738366356893,-96.8241746664009,-97.9438510991999,-99.0337716024107,-100.094852673337,-101.128015115727,-102.134178432198,-103.114256050879,-104.069151306002,-104.999754094477,-105.90693813408,-106.791558753373,-107.654451148495,-108.496429047256,-109.318283726312,-110.120783332469,-110.904672464215,-111.670671974379,-112.419478959282,-113.151766903851,-113.868185955957,-114.569363306638,-115.255903655943,-115.928389746885,-116.587382952447,-117.23342390273,-117.867033141263,-118.488711801169,-119.09894229333,-119.698189],"lat":[51.509865,52.1120911941854,52.7046021694843,53.2869176234257,53.858535054817,54.4189294174047,54.9675529183898,55.5038349919686,56.0271824810978,56.5369800634765,57.0325909601423,57.5133579668467,57.9786048492616,58.4276381427604,58.8597493956914,59.2742178913695,59.6703138781157,60.0473023282739,60.40444723599,60.7410164495479,61.0562870172457,61.3495510064459,61.6201217340275,61.8673403238026,62.0905824835961,62.2892653729382,62.4628544131925,62.610869877038,62.7328930850876,62.8285720353998,62.8976262977022,62.9398510187353,62.9551199080671,62.943387104144,62.9046878567301,62.8391380021483,62.7469322494718,62.6283413364111,62.4837081506661,62.3134429438052,62.1180177887247,61.8979604474443,61.6538478231642,61.3862991694977,61.0959692215163,60.7835413990125,60.4497212137178,60.0952299907222,59.7207989915412,59.3271640035187,58.9150604386355,58.4852189651358,58.0383616782231,57.5751988017104,57.0964259009944,56.6027215789771,56.094745620347,55.5731375456741,55.0385155347192,54.491475677872,53.9325915153804,53.3624138257002,52.7814706266313,52.1902673556595,51.5892871989284,50.9789915413585,50.3598205135005,49.7321936136789,49.0965103867804,48.4531511436412,47.8024777073641,47.1448341750373,46.4805476852418,45.8099291834209,45.1332741786671,44.4508634867636,43.7629639554217,43.0698291686032,42.371700127613,41.668805907324,40.9613642864565,40.2495823512997,39.5336570726436,38.8137758559986,38.090117065427,37.3628505215061,36.6321379740911,35.8981335506638,35.1609841811314,34.42083]}]],[[{"lng":[31.496773,31.3740807990202,31.2491411869552,31.1218330815247,30.9920286035487,30.8595925323986,30.7243817112597,30.5862443966155,30.4450195456477,30.3005360344353,30.1526117988947,30.0010528893293,29.8456524282126,29.6861894593972,29.5224276752812,29.354114006538,29.1809770567771,29.0027253618929,28.819045450809,28.6295996807529,28.4340238159988,28.2319243140738,28.0228752775855,27.8064150229147,27.5820422088022,27.3492114580737,27.1073283940456,26.855743999127,26.5937481862565,26.3205624534321,26.0353314669107,25.7371133886371,25.4248687268359,25.0974474438328,24.753574],"lat":[30.0263,30.8953021075939,31.7641863320039,32.6329463047998,33.5015752981722,34.3700661959859,35.2384114621474,36.1066031059827,36.9746326442852,37.8424910596493,38.7101687546525,39.5776555013906,40.4449403858029,41.3120117461446,42.1788571048733,43.0454630931083,43.9118153667009,44.777898512805,45.6436959456717,46.5091897901902,47.3743607514642,48.2391879684354,49.1036488492374,49.9677188855756,50.8313714429613,51.6945775230747,52.5573054938634,53.4195207821799,54.2811855227926,55.1422581564221,56.0026929680268,56.8624395547992,57.7214422111839,58.5796392155685,59.436962]}]],[[{"lng":[126.633333,125.381533977633,124.122495769069,122.856771452481,121.584939620079,120.307602619984,119.025384584137,117.738929254695,116.44889762472,115.155965412182,113.860820389229,112.564159591312,111.266686432984,109.969107758906,108.672130859846,107.376460484122,106.082795875011,104.791827864168,103.504236050022,102.220686088538,100.941827121624,99.6682893659841,98.400681882321,97.139590541692,95.8855762024696,94.6391731079544,93.4008875112374,92.1711965305363,90.9505472349927,89.7393559578749,88.5380078313505,87.3468565345063,86.1662242441298,84.9964017759551,83.8376489026132,82.6901948334153,81.5542388403295,80.4299510140564,79.317473133961,78.2169196357245,77.1283786609328,76.0519131733637,74.9875621274517,73.9353416752564,72.8952463992125,71.8672505589566,70.8513093415935,69.8473601058446,68.8553236116051,67.8751052274971,66.9065961100286,65.9496743489539,65.0042060743451,64.0700465217521,63.1470410526158,62.2350261278237,61.3338302329506,60.4432747543083,59.5631748054449,58.6933400041826,57.8335752006742,56.9836811572856,56.1434551813924,55.3126917124046,54.4911828645197,53.6787189268456,52.8750888226442,52.0800805295227,51.2934814624495,50.5150788214916,49.7446599061814,48.9820123984002,48.2269246156421,47.4791857364793,46.738586],"lat":[45.75,45.9168759474871,46.0700040431774,46.2092339083211,46.3344270120044,46.4454573015437,46.5422117882914,46.6245910826617,46.6925098725597,46.7458973398939,46.7846975104424,46.8088695330362,46.8183878847936,46.8132424999818,46.7934388209711,46.7589977706758,46.709955646808,46.6463639392072,46.5682890724064,46.4758120764572,46.3690281898291,46.2480463989138,46.1129889192915,45.963990624436,45.8011984279519,45.6247706257404,45.4348762046752,45.2316941244536,45.0154125792573,44.786228245733,44.5443455235882,44.2899757748024,44.0233365670951,43.7446509268748,43.4541466064367,43.1520553696873,42.8386123001698,42.5140551346485,42.1786236250005,41.8325589306607,41.4761030433867,41.1094982456503,40.7329866035371,40.3468094946385,39.951207171065,39.546418357384,39.1326798830055,38.710226348288,38.2792898234322,37.8400995790471,37.3928818471396,36.9378596111581,36.4752524236429,36.0052762499759,35.5281433366849,35.0440621027464,34.553237052329,34.0558687074406,33.5521535589699,33.0422840346558,32.5264484825667,32.0048311687272,31.4776122875942,30.9449679841445,30.4070703864089,29.8640876473528,29.3161839950742,28.7635197903597,28.2062515907033,27.644532219965,27.0785108429034,26.5083330438838,25.9341409091194,25.3560731118607,24.774265]}]]],null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":false,"fillColor":"#03F","fillOpacity":0.2,"dashArray":null,"smoothFactor":1,"noClip":false},null,null,null,null,null]},{"method":"addCircleMarkers","args":[[51.509865,30.0263,45.75],[-0.118092,31.496773,126.633333],2,null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"green","weight":5,"opacity":1,"fill":true,"fillColor":"green","fillOpacity":0.2,"dashArray":null},null,null,null,null,null,null,null]},{"method":"addCircleMarkers","args":[[34.42083,59.436962,24.774265],[-119.698189,24.753574,46.738586],2,null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"red","weight":5,"opacity":1,"fill":true,"fillColor":"red","fillOpacity":0.2,"dashArray":null},null,null,null,null,null,null,null]},{"method":"addLegend","args":[{"colors":["green","red"],"labels":["Journey start","Journey end"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"unknown","title":null,"extra":null,"layerId":null,"className":"info legend"}]}],"limits":{"lat":[24.774265,62.9551199080671],"lng":[-119.698189,126.633333]}},"evals":[],"jsHooks":[]}</script>

<hr>
<div class="row">
    <div class="col-sm-4">
        <center> <span class="fa fa-star fa-2x text-center" style="color:Tomato"></span>
            <p><a href='/reproducability-ratings' data-toggle="tooltip" data-placement="right" title="" data-original-title="Click for info" style='font-weight:bold;color:black;text-decoration:underline;' target='_blank'>Citable Author<i class="fa fa-question-circle "></i></a>
                <br>
                Martin John Hadley
                <br>
                (<a href="https://orcid.org/0000-0002-3039-6849" target="orcid.widget" rel="noopener noreferrer" style="vertical-align:top;"  target='_blank'><img src="/img/orcid_16x16.png" style="width:1em;margin-right:.2em;" alt="ORCID iD icon">orcid.org/0000-0002-3039-6849</a>)
        </center>
    </div>
    <div class="col-sm-4">
        <center> <span class="fa fa-star fa-2x text-center" style="color:Tomato"></span>
            <p><a href='/reproducability-ratings' data-toggle="tooltip" data-placement="right" title="" data-original-title="Click for info" style='font-weight:bold;color:black;text-decoration:underline;' target='_blank'>Citable Data<i class="fa fa-question-circle "></i></a>
                <br>
                No real data used.
        </center>
    </div>
    <div class="col-sm-4">
        <center> <span class="fa fa-star-half-o fa-2x text-center" style="color:Tomato"></span>
            <p><a href='/reproducability-ratings' data-toggle="tooltip" data-placement="right" title="" data-original-title="Click for info" style='font-weight:bold;color:black;text-decoration:underline;' target='_blank'>Citable Code<i class="fa fa-question-circle "></i></a>
                <br>
                <a href="https://github.com/visibledata/visibledata.github.io/blob/master/content/blog/2018-02-28_great-circles-with-sf.Rmd" target="orcid.widget" rel="noopener noreferrer" style="vertical-align:top;"  target='_blank'><img src="/img/GitHub-Mark-32px.png" style="width:1em;margin-right:.5em;" alt="GitHub icon">.Rmd on GitHub</a>
        </center>
    </div>
</div>


</div>
</div>
